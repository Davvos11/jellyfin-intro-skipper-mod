"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2014],{42014:function(e,t,n){n.r(t),n.d(t,{default:function(){return a}}),n(98010),n(63238),n(69217),n(61013),n(27471),n(72326);var i=n(56705),r=n(44614),s=(n(45368),n(83225),n(664),n(21865),n(20716),n(78066),n(15359),n(76543)),l=n(47005);function a(e,t,n){function a(){i.ZP.show(),ApiClient.getNamedConfiguration("livetv").then((function(n){var l=n.ListingProviders.filter((function(e){return e.Id===t}))[0]||{};c=l.ListingsId,$("#selectListing",e).val(l.ListingsId||""),e.querySelector(".txtUser").value=l.Username||"",e.querySelector(".txtPass").value="",e.querySelector(".txtZipCode").value=l.ZipCode||"",l.Username&&l.Password?e.querySelector(".listingsSection").classList.remove("hide"):e.querySelector(".listingsSection").classList.add("hide"),e.querySelector(".chkAllTuners").checked=l.EnableAllTuners,l.EnableAllTuners?e.querySelector(".selectTunersSection").classList.add("hide"):e.querySelector(".selectTunersSection").classList.remove("hide"),function(t){ApiClient.getJSON(ApiClient.getUrl("LiveTv/ListingProviders/SchedulesDirect/Countries")).then((function(n){var i,r,s=[];for(var l in n){var a=n[l];if(a.length&&"ZZZ"!==l)for(i=0,r=a.length;i<r;i++)s.push({name:a[i].fullName,value:a[i].shortName})}s.sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0})),$("#selectCountry",e).html(s.map((function(e){return'<option value="'+e.value+'">'+e.name+"</option>"})).join("")).val(t.Country||""),$(e.querySelector(".txtZipCode")).trigger("change")}),(function(){s.ZP.alert({message:r.ZP.translate("ErrorGettingTvLineups")})})),i.ZP.hide()}(l),function(e,t,n){for(var i="",r=0,s=n.length;r<s;r++){var l=n[r];i+='<div class="listItem">';var a=t.EnabledTuners||[],o=t.EnableAllTuners||-1!==a.indexOf(l.Id)?" checked":"";i+='<label class="checkboxContainer listItemCheckboxContainer"><input type="checkbox" is="emby-checkbox" data-id="'+l.Id+'" class="chkTuner" '+o+"/><span></span></label>",i+='<div class="listItemBody two-line">',i+='<div class="listItemBodyText">',i+=l.FriendlyName||u(l.Type),i+="</div>",i+='<div class="listItemBodyText secondary">',i+=l.Url,i+="</div>",i+="</div>",i+="</div>"}e.querySelector(".tunerList").innerHTML=i}(e,l,n.TunerHosts)}))}function o(n){n?(i.ZP.show(),ApiClient.ajax({type:"GET",url:ApiClient.getUrl("LiveTv/ListingProviders/Lineups",{Id:t,Location:n,Country:$("#selectCountry",e).val()}),dataType:"json"}).then((function(t){$("#selectListing",e).html(t.map((function(e){return'<option value="'+e.Id+'">'+e.Name+"</option>"}))),c&&$("#selectListing",e).val(c),i.ZP.hide()}),(function(){s.ZP.alert({message:r.ZP.translate("ErrorGettingTvLineups")}),o(""),i.ZP.hide()}))):$("#selectListing",e).html("")}function u(e){switch(e=e.toLowerCase()){case"m3u":return"M3U Playlist";case"hdhomerun":return"HDHomerun";case"satip":return"DVB";default:return"Unknown"}}var c,d=this;d.submit=function(){e.querySelector(".btnSubmitListingsContainer").click()},d.init=function(){var u=!1===(n=n||{}).showCancelButton;e.querySelector(".btnCancel").classList.toggle("hide",u);var c=!1===n.showSubmitButton;e.querySelector(".btnSubmitListings").classList.toggle("hide",c),$(".formLogin",e).on("submit",(function(){return function(){i.ZP.show();var n={Type:"SchedulesDirect",Username:e.querySelector(".txtUser").value,EnableAllTuners:!0,Password:e.querySelector(".txtPass").value},l=t;l&&(n.Id=l),ApiClient.ajax({type:"POST",url:ApiClient.getUrl("LiveTv/ListingProviders",{ValidateLogin:!0}),data:JSON.stringify(n),contentType:"application/json",dataType:"json"}).then((function(e){s.ZP.processServerConfigurationUpdateResult(),t=e.Id,a()}),(function(){s.ZP.alert({message:r.ZP.translate("ErrorSavingTvProvider")})}))}(),!1})),$(".formListings",e).on("submit",(function(){return function(){var a=$("#selectListing",e).val();if(a){i.ZP.show();var o=t;ApiClient.getNamedConfiguration("livetv").then((function(t){var u=t.ListingProviders.filter((function(e){return e.Id===o}))[0];u.ZipCode=e.querySelector(".txtZipCode").value,u.Country=$("#selectCountry",e).val(),u.ListingsId=a,u.EnableAllTuners=e.querySelector(".chkAllTuners").checked,u.EnabledTuners=u.EnableAllTuners?[]:$(".chkTuner",e).get().filter((function(e){return e.checked})).map((function(e){return e.getAttribute("data-id")})),ApiClient.ajax({type:"POST",url:ApiClient.getUrl("LiveTv/ListingProviders",{ValidateListings:!0}),data:JSON.stringify(u),contentType:"application/json"}).then((function(){i.ZP.hide(),n.showConfirmation&&s.ZP.processServerConfigurationUpdateResult(),l.Events.trigger(d,"submitted")}),(function(){i.ZP.hide(),s.ZP.alert({message:r.ZP.translate("ErrorAddingListingsToSchedulesDirect")})}))}))}else s.ZP.alert({message:r.ZP.translate("ErrorPleaseSelectLineup")})}(),!1})),$(".txtZipCode",e).on("change",(function(){o(this.value)})),e.querySelector(".chkAllTuners").addEventListener("change",(function(t){t.target.checked?e.querySelector(".selectTunersSection").classList.add("hide"):e.querySelector(".selectTunersSection").classList.remove("hide")})),$(".createAccountHelp",e).html(r.ZP.translate("MessageCreateAccountAt",'<a is="emby-linkbutton" class="button-link" href="http://www.schedulesdirect.org" target="_blank">http://www.schedulesdirect.org</a>')),a()}}}}]);