"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[757,8013],{60757:function(e,t,n){n.r(t),n.d(t,{default:function(){return H}}),n(5769),n(98010),n(63238),n(23938),n(61418),n(61013),n(17460),n(14078),n(72410),n(55849),n(95623);var a=n(47518),i=n(94389),r=n(56705),l=n(44614),o=n(83094),s=n(1892),c=n.n(s),u=n(95760),d=n.n(u),v=n(38311),f=n.n(v),m=n(58192),h=n.n(m),p=n(38060),P=n.n(p),y=n(54865),b=n.n(y),g=n(68141),S={};S.styleTagTransform=b(),S.setAttributes=h(),S.insert=f().bind(null,"head"),S.domAPI=d(),S.insertStyleElement=P(),c()(g.Z,S),g.Z&&g.Z.locals&&g.Z.locals;var Z,I=n(53913),k=n(61642),C=n(8013),L=n(56346),w=n(71616),T=[],q=[];function E(){var e=Z;if(e){e.parentNode.removeChild(e),Z=null,T=[],q=[];for(var t=document.querySelectorAll(".itemSelectionPanel"),n=0,a=t.length;n<a;n++){var i=t[n].parentNode;i.removeChild(t[n]),i.classList.remove("withMultiSelect")}}}function x(e,t){var n=o.ZP.parentWithAttribute(e,"data-id").getAttribute("data-id");if(t?T.filter((function(e){return e===n})).length||(T.push(n),q.push(e)):(T=T.filter((function(e){return e!==n})),q=q.filter((function(t){return t!==e}))),T.length){var a=document.querySelector(".itemSelectionCount");a&&(a.innerHTML=T.length)}else E()}function A(){x(this,this.checked)}function D(e,t){var n=e.querySelector(".itemSelectionPanel");if(!n){(n=document.createElement("div")).classList.add("itemSelectionPanel");var i=e.querySelector(".cardBox")||e.querySelector(".cardContent");i.classList.add("withMultiSelect"),i.appendChild(n);var r="chkItemSelect";t&&!a.Z.firefox&&(r+=" checkedInitial");var l=t?" checked":"";n.innerHTML='<label class="checkboxContainer"><input type="checkbox" is="emby-checkbox" data-outlineclass="multiSelectCheckboxOutline" class="'.concat(r,'"').concat(l,"/><span></span></label>"),n.querySelector(".chkItemSelect").addEventListener("change",A)}}function M(e){var t=I.Z.currentApiClient();t.getCurrentUser().then((function(a){t.getItem(t.getCurrentUserId(),T[0]).then((function(o){var s=[];s.push({name:l.ZP.translate("SelectAll"),id:"selectall",icon:"select_all"}),s.push({name:l.ZP.translate("AddToCollection"),id:"addtocollection",icon:"add"}),s.push({name:l.ZP.translate("AddToPlaylist"),id:"playlist",icon:"playlist_add"}),a.Policy.EnableContentDeletion&&s.push({name:l.ZP.translate("Delete"),id:"delete",icon:"delete"}),a.Policy.EnableContentDownloading&&i.M.supports("filedownload"),a.Policy.IsAdministrator&&s.push({name:l.ZP.translate("GroupVersions"),id:"groupvideos",icon:"call_merge"}),s.push({name:l.ZP.translate("MarkPlayed"),id:"markplayed",icon:"check_box"}),s.push({name:l.ZP.translate("MarkUnplayed"),id:"markunplayed",icon:"check_box_outline_blank"}),w.ZP.canRefreshMetadata(o,a)&&s.push({name:l.ZP.translate("RefreshMetadata"),id:"refresh",icon:"refresh"}),Promise.resolve().then(n.bind(n,78407)).then((function(a){a.show({items:s,positionTo:e.target,callback:function(e){var a=T.slice(0),i=t.serverInfo().Id;switch(e){case"selectall":for(var o=document.querySelectorAll(".itemSelectionPanel"),s=0,c=o.length;s<c;s++){var u=o[s].querySelector(".chkItemSelect");!u||u.classList.contains("checkedInitial")||u.checked||0==u.getBoundingClientRect().width||(u.checked=!0,x(u,!0))}break;case"addtocollection":n.e(6372).then(n.bind(n,86372)).then((function(e){new(0,e.default)({items:a,serverId:i})})),E(),N();break;case"playlist":new C.default({items:a,serverId:i}),E(),N();break;case"delete":(function(e,t){return new Promise((function(n,a){var i=l.ZP.translate("ConfirmDeleteItem"),r=l.ZP.translate("HeaderDeleteItem");t.length>1&&(i=l.ZP.translate("ConfirmDeleteItems"),r=l.ZP.translate("HeaderDeleteItems")),(0,L.Z)(i,r).then((function(){var i=t.map((function(t){return e.deleteItem(t)}));Promise.all(i).then(n,(function(){(function(e){return new Promise((function(t){(0,k.Z)(e).then(t,t)}))})(l.ZP.translate("ErrorDeletingItem")).then(a,a)}))}),a)}))})(t,a).then(N),E(),N();break;case"groupvideos":!function(e,t){t.length<2?(0,k.Z)({text:l.ZP.translate("PleaseSelectTwoItems")}):(r.ZP.show(),e.ajax({type:"POST",url:e.getUrl("Videos/MergeVersions",{Ids:t.join(",")})}).then((function(){r.ZP.hide(),E(),N()})))}(t,a);break;case"markplayed":a.forEach((function(e){t.markPlayed(t.getCurrentUserId(),e)})),E(),N();break;case"markunplayed":a.forEach((function(e){t.markUnplayed(t.getCurrentUserId(),e)})),E(),N();break;case"refresh":n.e(4231).then(n.bind(n,14231)).then((function(e){new(0,e.default)({itemIds:a,serverId:i}).show()})),E(),N()}}})}))}))}))}function N(){var e=[];[].forEach.call(q,(function(t){var n=o.ZP.parentWithAttribute(t,"is","emby-itemscontainer");n&&!e.includes(n)&&e.push(n)}));for(var t=0,n=e.length;t<n;t++)e[t].notifyRefreshNeeded(!0)}function O(e){Promise.resolve().then(n.bind(n,45368)).then((function(){for(var t=document.querySelectorAll(".card"),n=0,a=t.length;n<a;n++)D(t[n],e===t[n]);!function(){var e=Z;if(!e){(e=document.createElement("div")).classList.add("selectionCommandsPanel"),document.body.appendChild(e),Z=e;var t="";t+='<button is="paper-icon-button-light" class="btnCloseSelectionPanel autoSize"><span class="material-icons close" aria-hidden="true"></span></button>',t+='<h1 class="itemSelectionCount"></h1>',t+='<button is="paper-icon-button-light" class="btnSelectionPanelOptions autoSize" style="margin-left:auto;"><span class="material-icons '.concat("more_vert",'" aria-hidden="true"></span></button>'),e.innerHTML=t,e.querySelector(".btnCloseSelectionPanel").addEventListener("click",E);var n=e.querySelector(".btnSelectionPanelOptions");o.ZP.addEventListener(n,"click",M,{passive:!0})}}(),x(e,!0)}))}function U(e){var t=e.target;if(T.length){var n=o.ZP.parentWithClass(t,"card");if(n){var a=n.querySelector(".itemSelectionPanel");if(a)return function(e,t){if(!o.ZP.parentWithClass(e.target,"chkItemSelect")){var n=t.querySelector(".chkItemSelect");if(n)if(n.classList.contains("checkedInitial"))n.classList.remove("checkedInitial");else{var a=!n.checked;n.checked=a,x(n,a)}}return e.preventDefault(),e.stopPropagation(),!1}(e,a)}return e.preventDefault(),e.stopPropagation(),!1}}function H(e){var t,n,i,r,l,s=e.container;function c(e){var t=o.ZP.parentWithClass(e.target,"card");return t&&O(t),e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}function u(e){return e.changedTouches||e.targetTouches||e.touches}function d(e){var a=u(e)[0];if(t=null,i=0,r=0,a){i=a.clientX,r=a.clientY;var l=a.target;if(l){var s=o.ZP.parentWithClass(l,"card");s&&(n&&(clearTimeout(n),n=null),t=s,n=setTimeout(p,550))}}}function v(e){if(t){var n,a,l=u(e)[0];if(l){var o=l.clientX||0,s=l.clientY||0;n=Math.abs(o-(i||0)),a=Math.abs(s-(r||0))}else n=100,a=100;(n>=5||a>=5)&&h()}}function f(){h()}function m(e){n&&(clearTimeout(n),n=null),t=e.target,n=setTimeout(p,550)}function h(){n&&(clearTimeout(n),n=null),t=null}function p(){if(t){var e=o.ZP.parentWithClass(t,"card");t=null,e&&O(e)}}l=s,a.Z.touch&&!a.Z.safari?l.addEventListener("contextmenu",c):(o.ZP.addEventListener(l,"touchstart",d,{passive:!0}),o.ZP.addEventListener(l,"touchmove",v,{passive:!0}),o.ZP.addEventListener(l,"touchend",f,{passive:!0}),o.ZP.addEventListener(l,"touchcancel",f,{passive:!0}),o.ZP.addEventListener(l,"mousedown",m,{passive:!0}),o.ZP.addEventListener(l,"mouseleave",h,{passive:!0}),o.ZP.addEventListener(l,"mouseup",h,{passive:!0})),!1!==e.bindOnClick&&s.addEventListener("click",U),this.onContainerClick=U,this.destroy=function(){s.removeEventListener("click",U),s.removeEventListener("contextmenu",c);var e=s;o.ZP.removeEventListener(e,"touchstart",d,{passive:!0}),o.ZP.removeEventListener(e,"touchmove",v,{passive:!0}),o.ZP.removeEventListener(e,"touchend",f,{passive:!0}),o.ZP.removeEventListener(e,"mousedown",m,{passive:!0}),o.ZP.removeEventListener(e,"mouseleave",h,{passive:!0}),o.ZP.removeEventListener(e,"mouseup",h,{passive:!0})}}document.addEventListener("viewbeforehide",E)},8013:function(e,t,n){n.r(t),n.d(t,{showEditor:function(){return S}}),n(5769),n(52077),n(72482),n(61013),n(23938),n(63238),n(61418),n(17460),n(14078),n(99785);var a,i=n(65009),r=n.n(i),l=n(83094),o=n(90914),s=n(56705),c=n(78695),u=n(53218),d=n(8782),v=n(28978),f=n(86628),m=n(44614),h=(n(78066),n(83225),n(21865),n(20716),n(85427),n(6626),n(53913));function p(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function P(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e){var t=l.ZP.parentWithClass(this,"dialog"),n=t.querySelector("#selectPlaylistToAddTo").value,i=h.Z.getApiClient(a);return n?(v.set("playlisteditor-lastplaylistid",n),function(e,t,n){var a=t.querySelector(".fldSelectedItemIds").value||"";if("queue"===n)return u.O.queue({serverId:e.serverId(),ids:a.split(",")}),t.submitted=!0,void o.default.close(t);s.ZP.show();var i=e.getUrl("Playlists/".concat(n,"/Items"),{Ids:a,userId:e.getCurrentUserId()});e.ajax({type:"POST",url:i}).then((function(){s.ZP.hide(),t.submitted=!0,o.default.close(t)}))}(i,t,n)):function(e,t){s.ZP.show();var n=e.getUrl("Playlists",{Name:t.querySelector("#txtNewPlaylistName").value,Ids:t.querySelector(".fldSelectedItemIds").value||"",userId:e.getCurrentUserId()});e.ajax({type:"POST",url:n,dataType:"json",contentType:"application/json"}).then((function(n){s.ZP.hide();var a=n.Id;t.submitted=!0,o.default.close(t),function(e,t){f.appRouter.showItem(t,e.serverId())}(e,a)}))}(i,t),e.preventDefault(),!1}function b(e){e.dispatchEvent(new CustomEvent("change",{}))}function g(e,t,a){Promise.resolve().then(n.bind(n,74227)).then((function(n){var i=a?"on":"off";n.centerFocus[i](e,t)}))}var S=P((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.items||{};a=t.serverId;var i={removeOnClose:!0,scrollY:!1};c.Z.tv?i.size="fullscreen":i.size="small";var l=o.default.createDialog(i);l.classList.add("formDialog");var f="",p=m.ZP.translate("HeaderAddToPlaylist");return f+='<div class="formDialogHeader">',f+='<button is="paper-icon-button-light" class="btnCancel autoSize" tabindex="-1" title="'.concat(m.ZP.translate("ButtonBack"),'"><span class="material-icons arrow_back" aria-hidden="true"></span></button>'),f+='<h3 class="formDialogHeaderTitle">',f+=p,f+="</h3>",f+="</div>",f+=function(e){var t="";t+='<div class="formDialogContent smoothScrollY" style="padding-top:2em;">',t+='<div class="dialogContentInner dialog-content-centered">',t+='<form style="margin:auto;">',t+='<div class="fldSelectPlaylist selectContainer">';var n=e.length?" autofocus":"";return t+='<select is="emby-select" id="selectPlaylistToAddTo" label="'.concat(m.ZP.translate("LabelPlaylist"),'"').concat(n,"></select>"),t+="</div>",t+='<div class="newPlaylistInfo">',t+='<div class="inputContainer">',n=e.length?"":" autofocus",t+='<input is="emby-input" type="text" id="txtNewPlaylistName" required="required" label="'.concat(m.ZP.translate("LabelName"),'"').concat(n," />"),t+="</div>",t+="</div>",t+='<div class="formDialogFooter">',t+='<button is="emby-button" type="submit" class="raised btnSubmit block formDialogFooterItem button-submit">'.concat(m.ZP.translate("Add"),"</button>"),t+="</div>",t+='<input type="hidden" class="fldSelectedItemIds" />',t+="</form>",(t+="</div>")+"</div>"}(n),l.innerHTML=f,function(e,t,n){if(e.querySelector("#selectPlaylistToAddTo").addEventListener("change",(function(){this.value?(e.querySelector(".newPlaylistInfo").classList.add("hide"),e.querySelector("#txtNewPlaylistName").removeAttribute("required")):(e.querySelector(".newPlaylistInfo").classList.remove("hide"),e.querySelector("#txtNewPlaylistName").setAttribute("required","required"))})),e.querySelector("form").addEventListener("submit",y),e.querySelector(".fldSelectedItemIds",e).value=n.join(","),n.length)e.querySelector(".fldSelectPlaylist").classList.remove("hide"),function(e,t){var n=t.querySelector("#selectPlaylistToAddTo");s.ZP.hide(),t.querySelector(".newPlaylistInfo").classList.add("hide");var i=h.Z.getApiClient(a);i.getItems(i.getCurrentUserId(),{Recursive:!0,IncludeItemTypes:"Playlist",SortBy:"SortName",EnableTotalRecordCount:!1}).then((function(t){var a="";(!1!==e.enableAddToPlayQueue&&u.O.isPlaying()||d.Z.Manager.isSyncPlayEnabled())&&(a+='<option value="queue">'.concat(m.ZP.translate("AddToPlayQueue"),"</option>")),a+='<option value="">'.concat(m.ZP.translate("OptionNew"),"</option>"),a+=t.Items.map((function(e){return'<option value="'.concat(e.Id,'">').concat(r()(e.Name),"</option>")})),n.innerHTML=a;var i=e.defaultValue;i||(i=v.get("playlisteditor-lastplaylistid")||""),n.value="new"===i?"":i,n.value||(n.value=""),b(n),s.ZP.hide()}))}(t,e);else{e.querySelector(".fldSelectPlaylist").classList.add("hide");var i=e.querySelector("#selectPlaylistToAddTo");i.innerHTML="",i.value="",b(i)}}(l,t,n),l.querySelector(".btnCancel").addEventListener("click",(function(){o.default.close(l)})),c.Z.tv&&g(l.querySelector(".formDialogContent"),!1,!0),o.default.open(l).then((function(){return c.Z.tv&&g(l.querySelector(".formDialogContent"),!1,!1),l.submitted?Promise.resolve():Promise.reject()}))}));t.default=S},68141:function(e,t,n){var a=n(54933),i=n.n(a),r=n(93476),l=n.n(r)()(i());l.push([e.id,".itemSelectionPanel{background-color:rgba(0,0,0,.3);bottom:0;left:0;position:absolute;right:0;top:0;z-index:99998}.selectionCommandsPanel{-webkit-align-items:center;align-items:center;display:-webkit-flex;display:flex;left:0;padding:1em .5em;position:fixed;right:0;top:0;z-index:99999}.itemSelectionCount{color:#fff!important;margin:0;vertical-align:middle}.multiSelectCheckboxOutline{border-radius:0!important;top:0!important}.withMultiSelect{position:relative}",""]),t.Z=l}}]);